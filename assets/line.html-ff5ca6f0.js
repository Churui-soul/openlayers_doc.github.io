import{_ as a,M as t,p,q as e,N as o,Q as n,t as c,a1 as l}from"./framework-e921cdd2.js";const i={},u=n("h1",{id:"线动画",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#线动画","aria-hidden":"true"},"#"),c(" 线动画")],-1),k=l(`<div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ol-map</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>map<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token comment">// 需要下载“arc”依赖</span>
<span class="token keyword">import</span> arc <span class="token keyword">from</span> <span class="token string">&#39;arc&#39;</span>

<span class="token keyword">import</span> OlMap <span class="token keyword">from</span> <span class="token string">&#39;./InitMap.vue&#39;</span>
<span class="token keyword">import</span> Feature <span class="token keyword">from</span> <span class="token string">&#39;ol/Feature.js&#39;</span>
<span class="token keyword">import</span> LineString <span class="token keyword">from</span> <span class="token string">&#39;ol/geom/LineString.js&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> getWidth <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;ol/extent.js&#39;</span>
<span class="token comment">// 图层</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Vector <span class="token keyword">as</span> VectorSource <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;ol/source.js&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Vector <span class="token keyword">as</span> VectorLayer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;ol/layer.js&#39;</span>
<span class="token comment">// 获取上下文</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> getVectorContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;ol/render.js&#39;</span>
<span class="token comment">// 样式</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Stroke<span class="token punctuation">,</span> Style <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;ol/style.js&#39;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        OlMap<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">_map</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
            <span class="token literal-property property">_tileLayer</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
            <span class="token literal-property property">_pointsPerMs</span><span class="token operator">:</span> <span class="token number">0.2</span><span class="token punctuation">,</span>
            <span class="token literal-property property">_flightsSource</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
            <span class="token literal-property property">_flightsStyle</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Style</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                <span class="token literal-property property">stroke</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Stroke</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">&#39;#ffa86f&#39;</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">.</span>_map <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">getMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">.</span>_tileLayer <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">.</span>_map<span class="token punctuation">.</span><span class="token function">getLayers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>array_<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">.</span>_map<span class="token punctuation">.</span><span class="token function">getView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setMinZoom</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">.</span>_map<span class="token punctuation">.</span><span class="token function">getView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setZoom</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addFlights</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token function">addFlights</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">.</span>_flightsSource <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">flightsSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

            <span class="token keyword">const</span> flightsLayer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VectorLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                <span class="token literal-property property">source</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">.</span>_flightsSource<span class="token punctuation">,</span>
                <span class="token function-variable function">style</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">feature</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>feature<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;finished&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">.</span>_flightsStyle
                    <span class="token punctuation">}</span>
                    <span class="token keyword">return</span> <span class="token keyword">null</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>

            <span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">.</span>_map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span>flightsLayer<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// 获取线路</span>
        <span class="token function">flightsSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">VectorSource</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                <span class="token function-variable function">loader</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">&#39;json/flights.json&#39;</span>
                    <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token punctuation">}</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">json</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                            <span class="token keyword">const</span> flightsData <span class="token operator">=</span> json<span class="token punctuation">.</span>flights
                            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> flightsData<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                                <span class="token keyword">const</span> flight <span class="token operator">=</span> flightsData<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
                                <span class="token keyword">const</span> from <span class="token operator">=</span> flight<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
                                <span class="token keyword">const</span> to <span class="token operator">=</span> flight<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>

                                <span class="token comment">// 将线变为圆弧状</span>
                                <span class="token keyword">const</span> arcGenerator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">arc<span class="token punctuation">.</span>GreatCircle</span><span class="token punctuation">(</span>
                                    <span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> from<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span> from<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
                                    <span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> to<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span> to<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>
                                <span class="token punctuation">)</span>

                                <span class="token keyword">const</span> arcLine <span class="token operator">=</span> arcGenerator<span class="token punctuation">.</span><span class="token function">Arc</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">offset</span><span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
                                <span class="token comment">// 穿过-180°/+180°子午线的路径是分开的</span>
                                <span class="token comment">// 分成两个部分，将它们依次动画运动</span>
                                <span class="token keyword">const</span> features <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
                                arcLine<span class="token punctuation">.</span>geometries<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">geometry</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                                    <span class="token keyword">const</span> line <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LineString</span><span class="token punctuation">(</span>geometry<span class="token punctuation">.</span>coords<span class="token punctuation">)</span>
                                    line<span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span><span class="token string">&#39;EPSG:4326&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;EPSG:3857&#39;</span><span class="token punctuation">)</span>

                                    features<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
                                        <span class="token keyword">new</span> <span class="token class-name">Feature</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                                            <span class="token literal-property property">geometry</span><span class="token operator">:</span> line<span class="token punctuation">,</span>
                                            <span class="token literal-property property">finished</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                                        <span class="token punctuation">}</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">)</span>
                                <span class="token punctuation">}</span><span class="token punctuation">)</span>
                                <span class="token comment">// 延迟动画</span>
                                <span class="token comment">// 使所有线在不同的时间开始</span>
                                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addLater</span><span class="token punctuation">(</span>features<span class="token punctuation">,</span> i <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">)</span>
                            <span class="token punctuation">}</span>
                            <span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">.</span>_tileLayer<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;postrender&#39;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>animateFlights<span class="token punctuation">)</span>
                        <span class="token punctuation">}</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// 航班运动动画</span>
        <span class="token function">animateFlights</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> vectorContext <span class="token operator">=</span> <span class="token function">getVectorContext</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
            <span class="token keyword">const</span> frameState <span class="token operator">=</span> event<span class="token punctuation">.</span>frameState
            vectorContext<span class="token punctuation">.</span><span class="token function">setStyle</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">.</span>_flightsStyle<span class="token punctuation">)</span>

            <span class="token keyword">const</span> features <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">.</span>_flightsSource<span class="token punctuation">.</span><span class="token function">getFeatures</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> features<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">const</span> feature <span class="token operator">=</span> features<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>feature<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;finished&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">// 只绘制动画尚未完成的线条</span>
                    <span class="token keyword">const</span> coords <span class="token operator">=</span> feature<span class="token punctuation">.</span><span class="token function">getGeometry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCoordinates</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token keyword">const</span> elapsedTime <span class="token operator">=</span> frameState<span class="token punctuation">.</span>time <span class="token operator">-</span> feature<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;start&#39;</span><span class="token punctuation">)</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>elapsedTime <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">const</span> elapsedPoints <span class="token operator">=</span> elapsedTime <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">.</span>_pointsPerMs

                        <span class="token comment">// 绘制完成设置状态</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>elapsedPoints <span class="token operator">&gt;=</span> coords<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            feature<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&#39;finished&#39;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
                        <span class="token punctuation">}</span>

                        <span class="token keyword">const</span> maxIndex <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>elapsedPoints<span class="token punctuation">,</span> coords<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
                        <span class="token keyword">const</span> currentLine <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LineString</span><span class="token punctuation">(</span>coords<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> maxIndex<span class="token punctuation">)</span><span class="token punctuation">)</span>

                        <span class="token comment">// 动画需要在当前和最近相邻的包装世界中</span>
                        <span class="token keyword">const</span> worldWidth <span class="token operator">=</span> <span class="token function">getWidth</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">.</span>_map<span class="token punctuation">.</span><span class="token function">getView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getProjection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getExtent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                        <span class="token keyword">const</span> offset <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">.</span>_map<span class="token punctuation">.</span><span class="token function">getView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCenter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">/</span> worldWidth<span class="token punctuation">)</span>

                        <span class="token comment">// 使用之前获取的矢量图形上下文绘制线条</span>
                        currentLine<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span>offset <span class="token operator">*</span> worldWidth<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
                        vectorContext<span class="token punctuation">.</span><span class="token function">drawGeometry</span><span class="token punctuation">(</span>currentLine<span class="token punctuation">)</span>
                        currentLine<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span>worldWidth<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
                        vectorContext<span class="token punctuation">.</span><span class="token function">drawGeometry</span><span class="token punctuation">(</span>currentLine<span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// 地图渲染动画</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">.</span>_map<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// 添加线路</span>
        <span class="token function">addLater</span><span class="token punctuation">(</span><span class="token parameter">features<span class="token punctuation">,</span> timeout</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            window<span class="token punctuation">.</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">let</span> start <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                features<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">feature</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    <span class="token comment">// 设置动画开始时间</span>
                    feature<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&#39;start&#39;</span><span class="token punctuation">,</span> start<span class="token punctuation">)</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">.</span>_flightsSource<span class="token punctuation">.</span><span class="token function">addFeature</span><span class="token punctuation">(</span>feature<span class="token punctuation">)</span>
                    <span class="token keyword">const</span> duration <span class="token operator">=</span> feature<span class="token punctuation">.</span><span class="token function">getGeometry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCoordinates</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$data<span class="token punctuation">.</span>_pointsPerMs
                    start <span class="token operator">+=</span> duration
                <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> timeout<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1);function r(d,v){const s=t("AnimationLine");return p(),e("div",null,[u,o(s),k])}const b=a(i,[["render",r],["__file","line.html.vue"]]);export{b as default};
